<?php
class Verification extends Service { private $config; public function onRegister() { parent::onRegister(); $this->config = $this->get('config'); } public function verifyInstallation() { $sp1fe925 = $this->config->data['services']['verify']; $sp26b997 = $sp1fe925['code']; $sp3bec42 = $sp1fe925['token']; return $this->verifyCodeToken($sp26b997, $sp3bec42); } public function verifyCodeToken($sp26b997, $sp3bec42) { if (is_array($sp26b997)) { return !empty($sp26b997[0]) && !empty($sp26b997[1]) && !empty($sp3bec42) && sha1(md5($sp26b997[0] . $sp26b997[1])) == $sp3bec42; } return !empty($sp26b997) && !empty($sp3bec42) && sha1(md5($sp26b997)) == $sp3bec42; } public function updateInstallation($sp26b997, $sp3bec42) { $this->config->updateParameters(array('services' => array('verify' => array('code' => $sp26b997, 'token' => $sp3bec42)))); } }