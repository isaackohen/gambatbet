function handleEmoji(){emojify.setConfig({img_dir:base_url+"themes/default/assets/components/trumbowyg/emojify/images/basic"}),emojify.run()}toastr.options={showMethod:"fadeIn",hideMethod:"fadeOut",closeMethod:"fadeOut",closeButton:!0,progressBar:!0,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"5000",showEasing:"swing",hideEasing:"swing",onclick:null},$(document).ready(function(){if($(".tip").tooltip(),$("#dob").datetimepicker({format:"YYYY-MM-DD",viewMode:"years"}),$("#date").datetimepicker({format:"YYYY-MM-DD"}),$(".topic-box, .post-box").fitVids(),$('[data-toggle="ajax-modal"]').click(function(e){e.preventDefault();var t=$(this).attr("href");return $.get(t).done(function(e){$("#myModal").html(e).modal({backdrop:"static"})}),!1}),$(".copy_api_key").click(function(e){$(this).select(),$(".help_copy_api_key").text("");try{var t=document.execCommand("copy")?"Key Copied":"Please press ctrl+c or right click to copy the api key"}catch(e){t="Oops, unable to copy, please press ctrl+c or right click to copy the api key"}$(this).parents(".list-box").find(".help_copy_api_key").text(t)}),$(".msg_link td:not(:first-child, :last-child)").css("cursor","pointer").click(function(e){var t=$(this).parent("tr").attr("data-page");window.location.href=site_url+"messages/conversation/"+$(this).parent("tr").attr("data-id")+(t>0?"?page="+t:"")}),$(document).on("click",".po-del",function(e){e.preventDefault();var t=$(this).attr("href"),o=$(this).attr("data-button-title");$(this).popover({container:"body",content:"<p>"+lang.action_x_undo+'</p><p class="text-center"><a href="'+t+'" class="btn btn-danger">'+(o||lang.delete)+'</a> <button class="btn btn-default po-no">'+lang.close+"</button></p>",title:lang.r_u_sure,html:!0,placement:"top",trigger:"click"}).popover("toggle")}),$(document).on("click",".po-no",function(e){$(".po-del").popover("hide")}),$(".select2").select2({minimumResultsForSearch:6}),$(".vote").click(function(){var e=$(this),t=e.data("action"),o=e.parent().parent(".vote-con"),i=o.data("postid"),a=o.data("cast");$.ajax({url:site_url+"ajax_calls/vote",type:"POST",cache:"false",data:{postid:i,action:t},success:function(i){if("up"==t){var n=parseInt(o.find(".total-up").text());o.find(".total-up").html(n+1),1==a&&o.find(".total-down").text(parseInt(o.find(".total-down").text()-1)),o.find(".vote-down").attr("disabled",!1)}else if("down"==t){n=parseInt(o.find(".total-down").text());o.find(".total-down").html(n+1),1==a&&o.find(".total-up").text(parseInt(o.find(".total-up").text()-1)),o.find(".vote-up").attr("disabled",!1)}e.addClass(".active"),1==Settings.change_vote?e.attr("disabled",!0):$(".vote").attr("disabled",!0),toastr.success(i,"Success!")},error:function(e){toastr.error(e,"Error!")}})}),$("#rating").rating({min:0,max:5,step:1,size:"sm",showCaption:!1,rtl:1==Settings.rtl}),$("#rating").change(function(){var e=$(this),t=parseInt(e.val()),o=e.parents(".stars-con"),i=o.data("postid"),a=parseFloat(o.data("stars")),n=parseInt(o.data("my-stars")),r=parseInt(o.data("cast")),s=parseInt(o.data("votes"));$.ajax({url:site_url+"ajax_calls/vote",type:"POST",cache:"false",data:{postid:i,stars:t},success:function(i){var l=1==r?a-n/s+t/s:(a*s+t)/(s+1);o.find(".thread-rating").rating("update",l),e.attr("data-disabled",!0),$(".total_votes").text(s+(1==r?0:1)),toastr.success(i,"Success!")},error:function(e){toastr.error(e,"Error!")}})}),$(".thread-rating").rating({showClear:!1,min:0,max:5,step:.01,size:"lg",disabled:!0,showCaption:!1,rtl:1==Settings.rtl}),$(".index-threads-rating").rating({showClear:!1,min:0,max:5,step:.01,size:"xs",disabled:!0,showCaption:!1,rtl:1==Settings.rtl}),$(document).on("click","#send-message",function(e){e.preventDefault();var t=$(this).closest("form"),o=t.attr("action");if(t.formValidation({framework:"bootstrap",excluded:":disabled"}).on("success.form.fv",function(e){e.preventDefault()}),t.data("formValidation").validate(),t.data("formValidation").isValid()){o=t.attr("action");$.post(o,t.serialize()).done(function(e){"success"==e.status?(toastr.success(e.msg,"Success!"),$("#myModal").modal("hide")):toastr.error(e.msg,"Error!")}).fail(function(){toastr.error("Error occurred! please try again.","Error!")})}}),$(document).on("click","#mread",function(e){$("#msg-action").append('<input name="action" value="mread">'),$("#msg-actions").submit()}),$(document).on("click","#munread",function(e){$("#msg-action").append('<input name="action" value="munread">'),$("#msg-actions").submit()}),$(document).on("click","#mimportant",function(e){$("#msg-action").append('<input name="action" value="mimportant">'),$("#msg-actions").submit()}),$(document).on("click","#munimportant",function(e){$("#msg-action").append('<input name="action" value="munimportant">'),$("#msg-actions").submit()}),$(document).on("click","#mdelete",function(e){$("#msg-action").append('<input name="action" value="mdelete">'),$("#msg-actions").submit()}),$(".file").change(function(){$("#subfile").val($(this).val())}),$("#browse, #subfile").click(function(){$(".file").click()}),"redactor"==Settings.editor)$("#editor").trumbowyg({lang:1==Settings.rtl?"ar":"en",btnsDef:{formtext:{dropdown:["p","h3","h4","blockquote"],ico:"p"},align:{dropdown:["justifyLeft","justifyCenter","justifyRight","justifyFull"],ico:"justifyLeft"},image:{dropdown:["insertImage","noembed","upload","uploadFile"],ico:"insertImage"}},btns:[["viewHTML"],["formtext"],["align"],["strong","em"],["link"],["image"],["unorderedList","orderedList"],["preformatted"],["emoji"],["fullscreen"]],removeformatPasted:!0,svgPath:base_url+"themes/default/assets/components/trumbowyg/ui/icons.svg",plugins:{upload:{serverPath:site_url+"upload/image",fileFieldName:"file",error:function(e){alert(e.responseJSON.msg)}},uploadFile:{serverPath:site_url+"upload/file",fileFieldName:"file",error:function(e){alert(e.responseJSON.msg)}}}}),handleEmoji(),$("#editor").bind("input propertychange",function(){handleEmoji()}),$("#editor").on("tbwchange",function(){handleEmoji()}),$(document).on("click",".quote-reply",function(e){var t=$(this).attr("id"),o=$("#reply"+t).parents(".post-box").find(".author").text(),i=$("#reply"+t).html();$("#editor").focus(),$("#editor").trumbowyg("html","<blockquote>"+i.trim()+' <span class="quoting">'+o+"</span></blockquote><br>")});else if("simpledme"==Settings.editor){var e=new SimpleMDE({element:document.getElementById("editor"),toolbar:["bold","italic","heading","unordered-list","ordered-list","image","link","code","quote","|","preview","guide"],forceSync:!0,spellChecker:!1,status:!1});$(document).on("click",".quote-reply",function(t){var o=$(this).attr("id"),i=$("#reply"+o).parents(".post-box").find(".author").text(),a=$("#mde"+o).text();e.value("> __"+lang.quoting+" "+i+"__ "+a.trim()+" "),e.codemirror.focus(),e.codemirror.setCursor(e.codemirror.lineCount(),0)})}else"sceditor"==Settings.editor&&($("#editor").sceditor({plugins:"bbcode",toolbar:"bold,italic,underline,left,center,right,justify,size,bulletlist,orderedlist,image,link,youtube,emoticon,code,quote,removeformat,source",height:200,emoticonsRoot:base_url+"themes/default/assets/smileys/",style:"minified/jquery.sceditor.default.min.css"}),$(document).on("click",".quote-reply",function(e){var t=$(this).attr("id"),o=$("#reply"+t).parents(".post-box").find(".author").text(),i=$("#mde"+t).text(),a=$("#editor").sceditor("instance");a.focus(),a.insert("[quote][b]"+lang.quoting+" "+o+"[/b] "+i.trim()+"[/quote] ")}));$(".select_all").change(function(){$(".select_msg").prop("checked",$(this).prop("checked")),$(".select_all").prop("checked",$(this).prop("checked"))}),$(".select_msg").change(function(){this.checked||$(".select_all").prop("checked",!1)});var t={},o={};$(document).on("change",".parent_category",function(e){if($(this).val()){var o=$(this).val();$.getJSON(site_url+"topics/get_child_categories/"+o).done(function(e){if(!1!==e.categories?($("#child_category").empty().append('<option value="0">'+lang.select_child+"</option>"),$.each(e.categories,function(){$("#child_category").append('<option value="'+this.id+'">'+this.name+"</option>")}),$("#child_category").select2("val",0)):($("#child_category").empty().append('<option value="0">'+lang.no_child+"</option>"),$("#child_category").select2("val",0)),!1!==e.fields)for(var o in $("#category_fields").empty().html(e.fields.html),$(".select2").select2({minimumResultsForSearch:6}),t=e.fields.names){var i=$("#"+t[o]);$("#addTopicForm").formValidation("addField",i)}else{for(var o in t){i=$("#"+t[o]);$("#addTopicForm").formValidation("removeField",i)}$("#category_fields").empty()}})}else{for(var i in $("#child_category").empty().append('<option value="0">'+lang.select_parent_first+"</option>"),$("#child_category").select2("val",0),t){var a=$("#"+t[i]);$("#addTopicForm").formValidation("removeField",a)}$("#category_fields").empty()}}),$(document).on("change","#child_category",function(e){if($(this).val()&&0!=$(this).val()){var t=$(this).val();$.getJSON(site_url+"topics/get_child_fields/"+t).done(function(e){if(!1!==e.fields)for(var t in $("#child_category_fields").empty().html(e.fields.html),$(".select2").select2({minimumResultsForSearch:6}),o=e.fields.names){var i=$("#"+o[t]);$("#addTopicForm").formValidation("addField",i)}else{for(var t in o){i=$("#"+o[t]);$("#addTopicForm").formValidation("removeField",i)}$("#child_category_fields").empty()}})}else{for(var i in o){var a=$("#"+o[i]);$("#addTopicForm").formValidation("removeField",a)}$("#child_category_fields").empty()}}),$(document).on("click",".user",function(e){e.preventDefault(),$(".user-info").hide();var t=$(this),o=t.attr("data-id");return t.next(".user-info").toggle(),t.next(".user-info").hasClass("load")&&(o?$.get(site_url+"ajax_calls/get_user_details/"+o).done(function(e){$(".user_"+o).next(".user-info").find(".hidden-content-box-left").html(e),$(".user_"+o).next(".user-info").removeClass("load")}):($(".user_"+o).next(".user-info").find(".hidden-content-box-left").html("<h3>"+lang.user_x_found+"</h3>"),$(".user_"+o).next(".user-info").removeClass("load"))),!1}),$(document).on("click",".hidden-content-box-left",function(e){if(!$(e.target).hasClass("skip"))return e.preventDefault(),!1}),$(document).on("click",function(e){$(".user-info").hide()}),$("#go-to-page").click(function(){var e=$("#page-num").val();page_url.indexOf("?")>-1?window.location.href=page_url+"&page="+e:window.location.href=page_url+"?page="+e}),$("#page-num").keypress(function(e){13==e.keyCode&&$("#go-to-page").click()}),$("#addPost").formValidation({framework:"bootstrap",excluded:":disabled"}),$("#userForm, #avatarForm, #pwForm").formValidation({framework:"bootstrap",excluded:":disabled"}),$(".post-box:last").addClass("last"),"smtp"==$("#protocol").val()?$("#smtp_config").slideDown():"sendmail"==$("#protocol").val()&&$("#sendmail_config").slideDown(),$("#protocol").change(function(){"smtp"==$(this).val()?($("#sendmail_config").slideUp(),$("#smtp_config").slideDown()):"sendmail"==$(this).val()?($("#smtp_config").slideUp(),$("#sendmail_config").slideDown()):($("#smtp_config").slideUp(),$("#sendmail_config").slideUp())}),"1"==$("#wp_login").val()&&$("#wordpress_config").slideDown(),$("#wp_login").change(function(){"1"==$(this).val()?$("#wordpress_config").slideDown():$("#wordpress_config").slideUp()}),$(".detach_bagde").click(function(e){e.preventDefault();var t=$(this),o=t.attr("data-id");return $.get(site_url+"users/detach_badge/"+o,function(e){toastr.success(e,"Success!"),t.parent("li.list-group-item").remove()}),!1}),$(".reload-captcha").click(function(e){e.preventDefault(),$.ajax({url:$(this).attr("href"),success:function(e){$(".captcha-image").html(e)}})}),$(".approve").click(function(e){e.preventDefault();var t=$(this).attr("href"),o=$(this).attr("data-id");return $.get(t,function(e){toastr.success(e,"Success!"),$("#"+o).remove()}),!1}),$(".delete_review").click(function(e){e.preventDefault();var t=$(this).attr("href"),o=$(this).attr("data-id");return $.ajax({url:t,dataType:"json",success:function(e){1==e.error?toastr.error(e.msg,"Error!"):(toastr.success(e.msg,"Success!"),$("#"+o).remove())},error:function(e){toastr.error("Action Failed","Error!")}}),!1})}),$(window).load(function(){var e=$(".avatar");$.each(e,function(){var e=$(this).data("name").toString().charAt(0).toUpperCase();$(this).css({"background-color":randomColor({luminosity:"dark"}),color:"#FFF","font-size":"180%",display:"block","border-radius":"45px",height:"45px",width:"45px",display:"flex","align-items":"center","justify-content":"center","text-align":"center"}).text(e)});var t=$(".tavatar");$.each(t,function(){var e=$(this).data("name").toString().charAt(0).toUpperCase();$(this).css({"background-color":randomColor({luminosity:"dark"}),color:"#FFF","font-size":"230%",display:"block","border-radius":"60px",height:"60px",width:"60px",display:"flex","align-items":"center","justify-content":"center","text-align":"center",margin:"0 auto"}).text(e)})}),$("#myModal").on("shown.bs.modal",function(e){"simpledme"==Settings.editor&&new SimpleMDE({element:document.getElementById("body"),toolbar:["bold","italic","heading","unordered-list","ordered-list","image","link","code","quote","|","preview","guide"],forceSync:!0,spellChecker:!1,status:!1}).render()}),$("#myModal").on("show.bs.modal",function(e){$(".select2").select2({minimumResultsForSearch:6}),$("#date").datetimepicker({format:"YYYY-MM-DD"}),$("#title").change(function(e){var t=$(this).val(),o=site_url+"get_slug?title="+t;$.get(o,function(e){$("#slug").val(e).change()})}),"redactor"==Settings.editor?($("#body").trumbowyg({lang:1==Settings.rtl?"ar":"en",btnsDef:{formtext:{dropdown:["p","h3","h4","blockquote"],ico:"p"},align:{dropdown:["justifyLeft","justifyCenter","justifyRight","justifyFull"],ico:"justifyLeft"},image:{dropdown:["insertImage","noembed","upload","uploadFile"],ico:"insertImage"}},btns:[["viewHTML"],["formtext"],["align"],["strong","em"],["link"],["image"],["unorderedList","orderedList"],["preformatted"],["emoji"],["fullscreen"]],removeformatPasted:!0,svgPath:base_url+"themes/default/assets/components/trumbowyg/ui/icons.svg",plugins:{upload:{serverPath:site_url+"upload/image",fileFieldName:"file",error:function(e){alert(e.responseJSON.msg)}},uploadFile:{serverPath:site_url+"upload/file",fileFieldName:"file",error:function(e){alert(e.responseJSON.msg)}}}}),handleEmoji(),$("#body").bind("input propertychange",function(){handleEmoji()}),$("#body").on("tbwchange",function(){handleEmoji()})):"sceditor"==Settings.editor&&$("#body").sceditor({plugins:"bbcode",toolbar:"bold,italic,underline,left,center,right,justify,size,bulletlist,orderedlist,image,link,youtube,emoticon,code,quote,removeformat,source",height:200,emoticonsRoot:base_url+"themes/default/assets/smileys/",style:"minified/jquery.sceditor.default.min.css"}),$(".reload-captcha").click(function(e){e.preventDefault(),$.ajax({url:$(this).attr("href"),success:function(e){$(".captcha-image").html(e)}})}),$("#editPost, #categoryForm, #pageForm, #badgeForm, #fieldForm").formValidation({framework:"bootstrap",excluded:":disabled"}),$("#addTopicForm").formValidation({framework:"bootstrap",excluded:":disabled",err:{container:"#errors"},fields:{protected:{validators:{notEmpty:{message:lang.who_can_see_required}}}}})}),$("#status, #uquery").change(function(e){window.location.href=site_url+"users?status="+$("#status").val()+"&uquery="+$("#uquery").val()}),$(document).ajaxStart(function(){$("#ajaxCall").show()}).ajaxStop(function(){$("#ajaxCall").hide()}),$.ajaxSetup({cache:!1});